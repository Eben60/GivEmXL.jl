<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · GivEmXL.jl</title><meta name="title" content="Docstrings · GivEmXL.jl"/><meta property="og:title" content="Docstrings · GivEmXL.jl"/><meta property="twitter:title" content="Docstrings · GivEmXL.jl"/><meta name="description" content="Documentation for GivEmXL.jl."/><meta property="og:description" content="Documentation for GivEmXL.jl."/><meta property="twitter:description" content="Documentation for GivEmXL.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GivEmXL.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../api_data-processing/">API data processing</a></li><li><a class="tocitem" href="../api_user-interaction/">API user interaction</a></li><li><a class="tocitem" href="../rc_example/">Toy Example #1: Fit exp decay curves</a></li><li><a class="tocitem" href="../noxl_example/">Toy Example #2: Read CSV, no excel</a></li><li><a class="tocitem" href="../create-from-template/">Creating project from template</a></li><li><a class="tocitem" href="../finally/">Finally</a></li><li class="is-active"><a class="tocitem" href>Docstrings</a><ul class="internal"><li><a class="tocitem" href="#Exported-Functions"><span>Exported Functions</span></a></li><li><a class="tocitem" href="#Public-and-Internal-Functions"><span>Public and Internal Functions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Eben60/GivEmXL.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Eben60/GivEmXL.jl/blob/main/docs/src/docstrings.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Exported-Functions"><a class="docs-heading-anchor" href="#Exported-Functions">Exported Functions</a><a id="Exported-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Exported-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.complete_interact-Tuple{Any, Any, Function}" href="#GivEmXL.complete_interact-Tuple{Any, Any, Function}"><code>GivEmXL.complete_interact</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">complete_interact(pp0, pps, proc_data_fn::Function; kwargs...) → nothing
complete_interact(pp0, pps, proc_data_fns::Tuple; kwargs...) → nothing</code></pre><p>This is the top level function for building the interaction with the user. See the flow diagram in the documentation for details. It calls <a href="#GivEmXL.proc_ARGS-Tuple{Any}"><code>proc_ARGS</code></a> first, <a href="#GivEmXL.prompt_and_parse-Tuple{Any}"><code>prompt_and_parse</code></a> multiple times, and lets user pick file(s) by a GUI.  The inputs are merged with the parameter in the excel file, and all that passed to user-provided function(s) to perform the data processing.</p><p><strong>Arguments</strong></p><ul><li><code>pp0::Union{Nothing, ArgumentParser}</code>: ArgumentParser for command line arguments.</li><li><code>pps::NamedTuple</code>: ArgumentParsers for individual dialogs. The corresponding keys are:    <code>[:gen_options, :spec_options, :exelfile_prompt, :datafiles_prompt, :next_file]</code>. To skip a dialog, skip the key.</li><li><code>proc_data_fn(; xlfile, datafiles, paramsets)::Function</code>: Function to do the actual data processing. It takes these three kwargs.</li><li><code>proc_data_fns::Tuple</code>: Alternatively a tuple of three functions can be provides:    For preprocessing, processing a subset, and postprocessing. See also <a href="#GivEmXL.proc_data-NTuple{6, Any}"><code>proc_data</code></a></li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>basedir=nothing</code>: The base directory for the file selection dialogs. If <code>basedir</code> not provided, uses the cached value.</li><li><code>paramtables = (;setup=&quot;params_setup&quot;, exper=&quot;params_experiment&quot;)</code>: The names of the tables containing the corresponding parameters.   Set a table to <code>nothing</code> to skip it.</li><li><code>getexel=false</code>: If true, execute excel file selection dialog.</li><li><code>getdata=(; dialogtype = :none)</code>: If <code>:none</code>, no data file selection dialog,    otherwise the parameter will be passed to the <a href="#GivEmXL.get_data-Tuple{}"><code>get_data</code></a> function to execute file/directory selection dialog.</li></ul><p>Function <code>complete_interact</code> is exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/interact.jl#L128-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.exper_paramsets" href="#GivEmXL.exper_paramsets"><code>GivEmXL.exper_paramsets</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exper_paramsets(userargs, df_exp, df_setup) → Vector{NamedTuple}</code></pre><p>Merges <code>userargs</code> with the parameter in <code>df_setup</code> and in each row of <code>df_exp</code></p><p><strong>Arguments</strong></p><ul><li><code>userargs</code>: Arguments (e.g. as NamedTuple) </li><li><code>df_exp::Union{Nothing, DataFrame}</code>: Experiment (subsets) parameter, as read from an excel file.</li><li><code>df_setup::Union{Nothing, DataFrame}</code>: Experiment setup parameter, as read from an excel file. </li></ul><p>Function <code>exper_paramsets</code> is exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/interact.jl#L103-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.proc_n_save-Tuple{Any, Any, Any}" href="#GivEmXL.proc_n_save-Tuple{Any, Any, Any}"><code>GivEmXL.proc_n_save</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">proc_n_save(procwhole_fn, procsubset_fn, postproc_fn;
    xlfile,
    datafiles=nothing, 
    paramsets = [(;)],
    ) → (; overview, subsets_results, résumé, errors, dfs)</code></pre><p>Calls <a href="#GivEmXL.proc_data-NTuple{6, Any}"><code>proc_data</code></a> with the user provided functions to process data followed by <a href="#GivEmXL.save_results-NTuple{4, Any}"><code>save_results</code></a>.  For explanation of arguments and returned values see docs on these functions.</p><p>Function <code>proc_n_save</code> is exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L320-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.read_xl_paramtables-Tuple{Any}" href="#GivEmXL.read_xl_paramtables-Tuple{Any}"><code>GivEmXL.read_xl_paramtables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_xl_paramtables(f_src; paramtables=(;setup=&quot;params_setup&quot;, exper=&quot;params_experiment&quot;)) 
    → (; df_setup::Union{Nothing, DataFrame}, df_exp::Union{Nothing, DataFrame})</code></pre><p>Reads the two tables (if not <code>nothing</code>) from an XLSX file into corresponding DataFrames and strips comments, if any.  Comment is any row starting with <code>#</code> </p><p><strong>Argument</strong></p><ul><li><code>f_src::String</code>: File path</li></ul><p><strong>Keyword argument</strong></p><ul><li><code>paramtables=(;setup::Union{Nothing, String}=&quot;params_setup&quot;, exper::Union{Nothing, String}=&quot;params_experiment&quot;)</code></li></ul><p><strong>Returned NamedTuple</strong></p><ul><li><code>(;df_setup::Union{Nothing, DataFrame}, df_exp::Union{Nothing, DataFrame}</code></li></ul><p>Function <code>read_xl_paramtables</code> is exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L51-L68">source</a></section></article><h2 id="Public-and-Internal-Functions"><a class="docs-heading-anchor" href="#Public-and-Internal-Functions">Public and Internal Functions</a><a id="Public-and-Internal-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Public-and-Internal-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.combine2df-Tuple{Any}" href="#GivEmXL.combine2df-Tuple{Any}"><code>GivEmXL.combine2df</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">combine2df(subsets_results) → Union{DataFrame, Nothing}</code></pre><p>Combines <code>NamedTuple</code>s (or equivalent) into a dataFrame.</p><p>Function <code>combine2df</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L198-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.get_data-Tuple{}" href="#GivEmXL.get_data-Tuple{}"><code>GivEmXL.get_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_data(;dialogtype, filterlist=&quot;&quot;, datadir=nothing) 
    → (; abort::Bool, datafiles)</code></pre><p>Calls the function <code>NativeFileDialog:</code> <code>pick_file(datadir; filterlist)</code> or <code>pick_multi_file(datadir; filterlist)</code>.  If <code>datadir</code> not provided, uses the cached value. Caches the selected directory. Returns file or folder or multiple files.</p><p><strong>Keyword arguments</strong></p><ul><li><code>dialogtype</code>: dialogtype ∈ [:single, :multiple, :folder]</li><li><code>datadir</code>: The base directory for file selection dialog.</li><li><code>filterlist</code>: Will be passed to <code>pick_file</code> / <code>pick_multi_file</code> function.</li></ul><p><strong>Throws</strong></p><ul><li>On unknown value of <code>dialogtype</code></li></ul><p>Function <code>get_data</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/get_files.jl#L43-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.get_xl-Tuple{}" href="#GivEmXL.get_xl-Tuple{}"><code>GivEmXL.get_xl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_xl(; basedir=nothing, paramtables = (;setup=&quot;params_setup&quot;, exper=&quot;params_experiment&quot;)) 
    → (;abort, xlargs=rslt, fname)</code></pre><p>Calls the function <code>NativeFileDialog:</code> <code>pick_file(datadir; filterlist)</code> to select an XLSX.  Passes the file to <code>read_xl_paramtables</code> to parse the parameter table(s) If <code>basedir</code> not provided, uses the cached value. Caches the selected directory. </p><p><strong>Keyword arguments</strong></p><ul><li><code>dialogtype</code>: dialogtype ∈ [:single, :multiple, :folder]</li><li><code>basedir</code>: The base directory for file selection dialog.</li></ul><p><strong>Returned NamedTuple</strong></p><ul><li><code>abort::Bool</code>: Dialog cancelled by user</li><li><code>xlargs::NamedTuple</code>: Tables read into DataFrames - s. <a href="#GivEmXL.read_xl_paramtables-Tuple{Any}"><code>read_xl_paramtables</code></a></li><li><code>fname::String</code>: Selected XLSX file</li></ul><p>Function <code>get_xl</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/get_files.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.makeproj" href="#GivEmXL.makeproj"><code>GivEmXL.makeproj</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">makeproj(tgt_folder, tgt_projname, tgt_scriptname, src::NamedTuple; 
    ignorecase=false, authors::Vector{String}=String[], force=false) → nothing
makeproj(tgt_folder, tgt_projname, tgt_scriptname, src::Symbol; kwargs...)</code></pre><p>Create a project by copying a template project and performing renamings as necessary. Destination folder must be different from the enclosing folder of the source.</p><p><strong>Arguments</strong></p><ul><li><code>tgt_folder::AbstractString</code>: Destination folder</li><li><code>tgt_projname::AbstractString</code>: The name of the project to be created</li><li><code>tgt_scriptname::AbstractString</code>: The name of the executable script</li><li><code>src::Symbol</code>: Accepts either <code>:default</code> (the default template), or <code>:example1</code>    for Toy Example #1, or <code>:example2</code> for Toy Example #2 provided with <code>GivEmXL</code></li><li><code>src::@NamedTuple{src_folder::String, src_scriptname::String}</code>: E.g. it would be    <code>src=(; src_folder=&quot;userproj_template/Template_ProjName&quot;, src_scriptname=&quot;template_user_scriptname&quot;)</code>    for the default template</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>ignorecase=false</code>: Ignore case in the file paths</li><li><code>authors::Vector{T}=String[] where T &lt;: AbstractString</code>: The project authors (goes to <code>Project.toml</code>)</li><li><code>force=false</code>: If true, will overwrite the destination.</li></ul><p>Function <code>makeproj</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/create_user_proj.jl#L171-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.merge_params-Tuple{Any, Any, Any}" href="#GivEmXL.merge_params-Tuple{Any, Any, Any}"><code>GivEmXL.merge_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_params(df_exp::Union{Nothing, DataFrame}, df_setup::Union{Nothing, DataFrame}, row::Integer) → (;nt, nt_exp, nt_setup, nt_unitless)</code></pre><p>Merges default parameters and units from <code>df_setup</code> with the parameter in the given row of <code>df_exp</code>, and returns them as NamedTuple of NamedTuples.  Actually only the <code>nt</code> field of the returned value is used.</p><p>Function <code>merge_params</code> is public.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; m = GivEmXL.merge_params(df_exp, df_setup, 1);
julia&gt; m.nt
(area = 0.5 cm², Vunit = mV, timeunit = s, Cunit = nF, R = 5 GΩ, t_start = 1 s, t_stop = 4 s, ϵ = 3.7, no = 1, plot_annotation = &quot;first discharge&quot;, comment = &quot;first discharge – 1&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L116-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.mergent-Tuple{Any}" href="#GivEmXL.mergent-Tuple{Any}"><code>GivEmXL.mergent</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mergent(args::Array) → ::NamedTuple
mergent(args...) → ::NamedTuple</code></pre><p>Merges multiple <code>NamedTuple</code>s, or arguments convertible to <code>NamedTuple</code>s (e.g. <code>Dict</code>, <code>pairs</code>).</p><p>Function <code>mergent</code> is internal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L141-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.nt2unitful-Tuple{Any, Any}" href="#GivEmXL.nt2unitful-Tuple{Any, Any}"><code>GivEmXL.nt2unitful</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nt2unitful(nt, ntunits) → NamedTuple</code></pre><p>Applies units from <code>ntunits</code> to the values from <code>nt</code></p><p>Function <code>nt2unitful</code> is internal.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; nt2unitful((; a=2.0, b=3), (;a=u&quot;cm/s&quot;))
(a = 2.0 cm s⁻¹, b = 3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L96-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.out_paths-Tuple{Any}" href="#GivEmXL.out_paths-Tuple{Any}"><code>GivEmXL.out_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">out_paths(f_src) → (;fname, f_src, src_dir, rslt_dir, outf, errf)</code></pre><p>From given source path, generates names and paths used for sources and results.</p><p>Function <code>out_paths</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L35-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.parse_cl_string-Tuple{Any}" href="#GivEmXL.parse_cl_string-Tuple{Any}"><code>GivEmXL.parse_cl_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_cl_string(s::AbstractString) →  ::String[]</code></pre><p>Wrapper around Base.shell_split</p><p>Function <code>parse_cl_string</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/interact.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.proc_ARGS-Tuple{Any}" href="#GivEmXL.proc_ARGS-Tuple{Any}"><code>GivEmXL.proc_ARGS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">proc_ARGS(pp0::Nothing) = (;abort=false, argpairs = emptyargs())
proc_ARGS(pp0::ArgumentParser) → (;abort, argpairs)</code></pre><p>Reads and parses the arguments provided to the script from the command line. See the flow diagram in the documentation for details.</p><p><strong>Arguments</strong></p><ul><li><code>pp0::Union{Nothing, ArgumentParser}</code>: ArgumentParser for command line arguments.</li></ul><p><strong>Returned NamedTuple</strong></p><ul><li><code>abort::Bool</code></li><li><code>argpairs</code>: Vector of pairs <code>argname::Symbol =&gt; argvalue::Any</code></li></ul><p>Function <code>proc_ARGS</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/interact.jl#L68-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.proc_data-NTuple{6, Any}" href="#GivEmXL.proc_data-NTuple{6, Any}"><code>GivEmXL.proc_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">proc_data(xlfile, datafiles, paramsets, procwhole_fn, procsubset_fn, postproc_fn; throwonerr=false) 
    → (; overview, subsets_results, résumé, errors)</code></pre><p>Calls the user provided data processing functions.</p><p><strong>Arguments</strong></p><ul><li><code>xlfile</code>: XLSX file (if any)</li><li><code>datafiles</code>: Data file(s) or folder (if any)</li><li><code>paramsets::Vector{NamedTuple}</code>: Parameter merged from those supplied by user as cli arguments and those contained in the excel file.</li><li><code>procwhole_fn::Union{Nothing, Function}</code>: User supplied function for preprocessing</li><li><code>procsubset_fn::Union{Nothing, Function}</code>: User supplied function for processing a data subset</li><li><code>postproc_fn::Union{Nothing, Function}</code>: User supplied function for postprocessing</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>throwonerr=false</code>: If <code>true</code>, <code>Julia</code> execution will stop on an error and print error information, otherwise execution continues    and error information can be saved into a separate file.</li></ul><p><strong>Returned NamedTuple</strong></p><ul><li><code>overview::NamedTuple</code>: May contain <code>DataFrame</code>(s) and plot objects as returned by <code>procwhole_fn</code> function</li><li><code>subsets_results::Vector{NamedTuple}</code>: May contain a <code>DataFrame</code> row and plot objects for each subset as returned by <code>procsubset_fn</code></li><li><code>résumé::NamedTuple</code>: May contain <code>DataFrame</code>(s) and plot objects as returned by <code>postproc_fn</code> function</li><li><code>errors::Vector{NamedTuple}</code>: Collects information on errors if any occurred.</li></ul><p>Function <code>proc_data</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L145-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.prompt_and_parse-Tuple{Any}" href="#GivEmXL.prompt_and_parse-Tuple{Any}"><code>GivEmXL.prompt_and_parse</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prompt_and_parse(pp::Nothing) = (;abort=false, argpairs = emptyargs())
prompt_and_parse(pp::ArgumentParser) → (;abort, argpairs)</code></pre><p>Prints a prompt, read and parses the input from the user. See the flow diagram in the documentation for details.</p><p><strong>Arguments</strong></p><ul><li><code>pp::Union{Nothing, ArgumentParser}</code>: ArgumentParser for command line arguments.</li></ul><p><strong>Returned NamedTuple</strong></p><ul><li><code>abort::Bool</code></li><li><code>argpairs</code>: Vector of pairs <code>argname::Symbol =&gt; argvalue::Any</code></li></ul><p>Function <code>prompt_and_parse</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/interact.jl#L14-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.read_units-Tuple{Any}" href="#GivEmXL.read_units-Tuple{Any}"><code>GivEmXL.read_units</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_units(df_setup::DataFrame) → NamedTuple
read_units(d::Nothing) = (;)</code></pre><p>Function <code>read_units</code> is internal.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; GivEmXL.read_units(df_setup)
(area = cm², Vunit = mV, timeunit = s, Cunit = nF, R = GΩ, t_start = s, t_stop = s, ϵ = missing)

julia&gt; typeof(ans.timeunit)
Unitful.FreeUnits{(s,), 𝐓, nothing}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L76-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.remove_comments-Tuple{Any}" href="#GivEmXL.remove_comments-Tuple{Any}"><code>GivEmXL.remove_comments</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_comments(df::DataFrame) → ::DataFrame</code></pre><p>Comment is any row starting with <code>#</code> - these rows will be omitted.</p><p>Function <code>remove_comments</code> is internal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L36-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.s2unit-Tuple{Any}" href="#GivEmXL.s2unit-Tuple{Any}"><code>GivEmXL.s2unit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s2unit(str::AbstractString) → ::Quantity</code></pre><p>Strips all kinds of quotation marks and parses a string into <code>Quantity</code>.  See also <code>Unitful.uparse</code></p><p><strong>Throws</strong></p><ul><li>On conversion error</li></ul><p>Function <code>s2unit</code> is internal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/process_data.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.save_all_plots-NTuple{5, Any}" href="#GivEmXL.save_all_plots-NTuple{5, Any}"><code>GivEmXL.save_all_plots</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_all_plots(overview, subsets_results, résumé, rslt_dir, paramsets) → nothing</code></pre><p>Saves plot objects as generated by the three data processing functions into files of given format.</p><p><strong>Arguments</strong></p><ul><li><code>overview</code>, <code>subsets_results</code>, <code>résumé</code>::NamedTuple: Results of actual data processing in the form (; plots=(;df1, df2...), ...).    The key &#39;plots&#39; is optional.</li><li><code>rslt_dir</code>: directory where to put files.</li><li><code>paramsets::Vector{NamedTuple}</code>: If paramsets[1] has field <code>plotformat</code>, it will be the format for saving plots. </li></ul><p>Function <code>save_all_plots</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L262-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.save_dfs-NTuple{4, Any}" href="#GivEmXL.save_dfs-NTuple{4, Any}"><code>GivEmXL.save_dfs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_dfs(overview, subsets_results, résumé, outf) → NamedTuple</code></pre><p>Saves <code>DataFrames</code> as generated by the three data processing functions into (multiple) tables of an XLSX file</p><p><strong>Arguments</strong></p><ul><li><code>overview</code>, <code>subsets_results</code>, <code>résumé</code>::NamedTuple: Results of actual data processing in the form (; dataframes=(;df1, df2...), ...).    The key &#39;dataframes&#39; is optional.</li><li><code>outf</code>: target XLSX file.</li></ul><p><strong>Returns</strong></p><ul><li><code>dfs</code>: a NamedTuple of DataFrames</li></ul><p>Function <code>save_dfs</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L232-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.save_results-NTuple{4, Any}" href="#GivEmXL.save_results-NTuple{4, Any}"><code>GivEmXL.save_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_results(results, xlfile, paramsets) → (;dfs)</code></pre><p>Calls the functions <a href="#GivEmXL.save_dfs-NTuple{4, Any}"><code>save_dfs</code></a>, <a href="#GivEmXL.save_all_plots-NTuple{5, Any}"><code>save_all_plots</code></a>, <a href="#GivEmXL.write_errors-Tuple{Any, Any}"><code>write_errors</code></a> to save the results and errors.</p><p><strong>Arguments</strong></p><ul><li><code>results</code>: <code>NamedTuple</code> having structure <code>(; overview, subsets_results, résumé, errors)</code></li><li><code>overview</code>, <code>subsets_results</code>, <code>résumé</code>::NamedTuple: Results of actual data processing in the form (; plots=(;df1, df2...), ...).    The key &#39;plots&#39; is optional.</li><li><code>xlfile</code>: Path to the XLSX file with the parameter.</li><li><code>paramsets::Vector{NamedTuple}</code> </li></ul><p><strong>Returned value</strong></p><ul><li><code>(;dfs)</code>: A NamedTuple of DataFrames as returned by <a href="#GivEmXL.save_dfs-NTuple{4, Any}"><code>save_dfs</code></a> </li></ul><p>Function <code>save_results</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L293-L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.saveplots-Tuple{Any, Any}" href="#GivEmXL.saveplots-Tuple{Any, Any}"><code>GivEmXL.saveplots</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saveplots(rs, rslt_dir; plotformat = &quot;png&quot;, kwargs...) → nothing</code></pre><p>Saves plot objects as generated by a data processing function into files of given format.</p><p><strong>Arguments</strong></p><ul><li><code>rs</code>: NamedTuple with the processing results.</li><li><code>rslt_dir</code>: directory where to put files. </li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>plotformat = &quot;png&quot;</code>: If plotformat == &quot;none&quot;, do not save.</li><li>Other kwargs will be ignored.</li></ul><p>Function <code>saveplots</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L110-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.write_errors-Tuple{Any, Any}" href="#GivEmXL.write_errors-Tuple{Any, Any}"><code>GivEmXL.write_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_errors(errf, errors) → errored::Bool</code></pre><p>Saves backtraces of errors into a file.</p><p><strong>Arguments</strong></p><ul><li><code>errf</code>: File where errors will be saved.</li><li><code>errors</code>: Array of backtraces</li></ul><p><strong>Returns</strong></p><ul><li><code>errored</code>: <code>false</code> if <code>errors</code> was an empty array.</li></ul><p>Function <code>write_errors</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L66-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GivEmXL.write_xl_tables-Tuple{Any, Any}" href="#GivEmXL.write_xl_tables-Tuple{Any, Any}"><code>GivEmXL.write_xl_tables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_xl_tables(fl, nt_dfs; overwrite=true) → Nothing</code></pre><p>Writes multiple DataFrames into an XLSX file.</p><p><strong>Arguments</strong></p><ul><li><code>fl</code>: target XLSX file.</li><li><code>nt_dfs::NamedTuple</code>: DataFrames to save. <code>nt_dfs</code> keys will map to table names.  </li></ul><p>Function <code>write_xl_tables</code> is public, not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Eben60/GivEmXL.jl/blob/0e617985c12c12bd22d7723f16c67b9aa2f3148f/src/SavingResults.jl#L215-L225">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#GivEmXL.combine2df-Tuple{Any}"><code>GivEmXL.combine2df</code></a></li><li><a href="#GivEmXL.complete_interact-Tuple{Any, Any, Function}"><code>GivEmXL.complete_interact</code></a></li><li><a href="#GivEmXL.exper_paramsets"><code>GivEmXL.exper_paramsets</code></a></li><li><a href="#GivEmXL.get_data-Tuple{}"><code>GivEmXL.get_data</code></a></li><li><a href="#GivEmXL.get_xl-Tuple{}"><code>GivEmXL.get_xl</code></a></li><li><a href="#GivEmXL.makeproj"><code>GivEmXL.makeproj</code></a></li><li><a href="#GivEmXL.merge_params-Tuple{Any, Any, Any}"><code>GivEmXL.merge_params</code></a></li><li><a href="#GivEmXL.mergent-Tuple{Any}"><code>GivEmXL.mergent</code></a></li><li><a href="#GivEmXL.nt2unitful-Tuple{Any, Any}"><code>GivEmXL.nt2unitful</code></a></li><li><a href="#GivEmXL.out_paths-Tuple{Any}"><code>GivEmXL.out_paths</code></a></li><li><a href="#GivEmXL.parse_cl_string-Tuple{Any}"><code>GivEmXL.parse_cl_string</code></a></li><li><a href="#GivEmXL.proc_ARGS-Tuple{Any}"><code>GivEmXL.proc_ARGS</code></a></li><li><a href="#GivEmXL.proc_data-NTuple{6, Any}"><code>GivEmXL.proc_data</code></a></li><li><a href="#GivEmXL.proc_n_save-Tuple{Any, Any, Any}"><code>GivEmXL.proc_n_save</code></a></li><li><a href="#GivEmXL.prompt_and_parse-Tuple{Any}"><code>GivEmXL.prompt_and_parse</code></a></li><li><a href="#GivEmXL.read_units-Tuple{Any}"><code>GivEmXL.read_units</code></a></li><li><a href="#GivEmXL.read_xl_paramtables-Tuple{Any}"><code>GivEmXL.read_xl_paramtables</code></a></li><li><a href="#GivEmXL.remove_comments-Tuple{Any}"><code>GivEmXL.remove_comments</code></a></li><li><a href="#GivEmXL.s2unit-Tuple{Any}"><code>GivEmXL.s2unit</code></a></li><li><a href="#GivEmXL.save_all_plots-NTuple{5, Any}"><code>GivEmXL.save_all_plots</code></a></li><li><a href="#GivEmXL.save_dfs-NTuple{4, Any}"><code>GivEmXL.save_dfs</code></a></li><li><a href="#GivEmXL.save_results-NTuple{4, Any}"><code>GivEmXL.save_results</code></a></li><li><a href="#GivEmXL.saveplots-Tuple{Any, Any}"><code>GivEmXL.saveplots</code></a></li><li><a href="#GivEmXL.write_errors-Tuple{Any, Any}"><code>GivEmXL.write_errors</code></a></li><li><a href="#GivEmXL.write_xl_tables-Tuple{Any, Any}"><code>GivEmXL.write_xl_tables</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../finally/">« Finally</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 22 December 2024 21:37">Sunday 22 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
