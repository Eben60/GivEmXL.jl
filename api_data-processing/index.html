<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API data processing · GivEmXL.jl</title><meta name="title" content="API data processing · GivEmXL.jl"/><meta property="og:title" content="API data processing · GivEmXL.jl"/><meta property="twitter:title" content="API data processing · GivEmXL.jl"/><meta name="description" content="Documentation for GivEmXL.jl."/><meta property="og:description" content="Documentation for GivEmXL.jl."/><meta property="twitter:description" content="Documentation for GivEmXL.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GivEmXL.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>API data processing</a><ul class="internal"><li><a class="tocitem" href="#API-data-processing"><span>API data processing</span></a></li></ul></li><li><a class="tocitem" href="../api_user-interaction/">API user interaction</a></li><li><a class="tocitem" href="../rc_example/">Toy Example #1: Fit exp decay curves</a></li><li><a class="tocitem" href="../noxl_example/">Toy Example #2: Read CSV, no excel</a></li><li><a class="tocitem" href="../create-from-template/">Creating project from template</a></li><li><a class="tocitem" href="../finally/">Finally</a></li><li><a class="tocitem" href="../docstrings/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API data processing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API data processing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Eben60/GivEmXL.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Eben60/GivEmXL.jl/blob/main/docs/src/api_data-processing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="API-data-processing"><a class="docs-heading-anchor" href="#API-data-processing">API data processing</a><a id="API-data-processing-1"></a><a class="docs-heading-anchor-permalink" href="#API-data-processing" title="Permalink"></a></h2><p>In a general case your calculation would processes multiple data subsets, wherein the processing is performed in three steps: preprocessing, processing of each subset in a loop, and postprocessing. Each step can be however skipped. Specifically if your data are not divided into subsets, you would put everything into the &quot;preprocessing&quot; function.</p><p>You have to provide the corresponding functions for each of the steps, except skipped ones. You have the free choice in respect to the names of these functions. Results of each step are merged with the results of the previous one and passed to the following one. The processing data and saving results is performed by the function <a href="../docstrings/#GivEmXL.proc_n_save-Tuple{Any, Any, Any}"><code>proc_n_save</code></a>, which calls the functions <a href="../docstrings/#GivEmXL.proc_data-NTuple{6, Any}"><code>proc_data</code></a> and <a href="../docstrings/#GivEmXL.save_results-NTuple{4, Any}"><code>save_results</code></a>, respectively. The results are saved into a sub-directory of the excel file folder, and contain plots, the multi-table results file in XLSX format, and, in case of errors, a text file with errors information.</p><h3 id="Parameter-passed-to-data-processing-functions"><a class="docs-heading-anchor" href="#Parameter-passed-to-data-processing-functions">Parameter passed to data processing functions</a><a id="Parameter-passed-to-data-processing-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-passed-to-data-processing-functions" title="Permalink"></a></h3><ul><li><code>xlfile::String</code>: path to the exel file (in general case, <code>Union{Nothing, String}</code>)</li><li><code>datafiles::Nothing</code>: we put our data into the same exel file (in general case, <code>Union{Nothing, String, Vector{String}}</code>)</li><li><code>paramsets::Vector{NamedTuple}</code>: In our case, there will be 3 NamedTuples, one for each row of the table <code>params_experiment</code>. Each NamedTuple will contain the data as defined in the corresponding row as well a (repeating) data from the user input (here only <code>plotformat</code> defined) and the table table <code>params_experiment</code>, e.g. </li></ul><pre><code class="nohighlight hljs">julia&gt; paramsets[1]
(plotformat = &quot;png&quot;, throwonerr = true, area = 0.5 cm², Vunit = mV, timeunit = s, Cunit = nF, R = 5 GΩ, t_start = 1 s, t_stop = 4 s, ϵ = 3.7, no = 1, plot_annotation = &quot;first discharge&quot;, comment = &quot;first discharge – 1&quot;)</code></pre><h3 id="Preprocessing"><a class="docs-heading-anchor" href="#Preprocessing">Preprocessing</a><a id="Preprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Preprocessing" title="Permalink"></a></h3><p>The preprocessing function must take three arguments discussed above, like <code>fn_preproc(xlfile, datafiles, paramsets)</code>, and expected to return a NamedTuple as following <code>(;plots, dataframes, data)</code>:</p><ul><li><code>plots::Union{Nothing, NamedTuple{(:plot_annotation, plots...)}}</code>: e.g. <code>(;plot_annotation=&quot;overview&quot;, ov1=pl1, ov2=pl2)</code> - here <code>pl1</code> and <code>pl2</code> are plot objects. The annotation will be a part of the file name(s), and if there are multiple plots, their names (e.g. <code>pl1</code>) will be compounded into the file name, too. Each plot will be eventually saved to a separate file.</li><li><code>dataframes::Union{Nothing, NamedTuple{(dataframes...)}}</code>: e.g. <code>(; overview_table=df1)</code>. Each dataframe will be saved into a correspondingly named table of the results file in XLSX format.</li><li><code>data::Any</code>: The data to be passed to the following processing steps.</li></ul><h3 id="Subset-processing"><a class="docs-heading-anchor" href="#Subset-processing">Subset processing</a><a id="Subset-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Subset-processing" title="Permalink"></a></h3><p>The subset processing function must take arguments like following: <code>fn_subset(i, pm_subset, overview, xlfile, datafiles, paramsets)</code>:</p><ul><li><code>i</code>: Subset number.</li><li><code>pm_subset=paramsets[i]</code>: For <code>paramsets</code>, see above (and yes, I know, it&#39;s kind of redundant).</li><li><code>overview::NamedTuple{(:plots, :dataframes, :data)}</code>: NamedTuple as returned by the preprocessing function.</li><li>for the rest of the arguments, see above.</li></ul><p>It is expected to return a <code>NamedTuple</code> as following <code>(;rs, df_row)</code>:</p><ul><li><code>rs::NamedTuple{(:subset, :plot_annotation, plots..., more results... )}</code>: Where <code>subset=i</code>, and <code>plot_annotation</code> and <code>plots...</code> have the same meaning as for preprocessing.</li><li><code>df_row::NamedTuple</code>: The subset results to be afterwards concatenated into a <code>DataFrame</code> and saved as a table of an excel file.</li></ul><h3 id="Postprocessing"><a class="docs-heading-anchor" href="#Postprocessing">Postprocessing</a><a id="Postprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocessing" title="Permalink"></a></h3><p>The postprocessing function must take arguments like following: <code>fn_postproc(xlfile, datafiles, paramsets, overview, subsets_results)</code>:</p><ul><li><code>subsets_results::Vector{NamedTuple{(:rs, :df_row)}}</code>: Concatenation of subset processing results.</li><li>for all other parameters, see above.</li></ul><p>It is expected to return a <code>NamedTuple</code> as following <code>(;plots, :dataframes)</code> - see <strong>Preprocessing</strong> above for details.</p><h3 id="Plot-objects"><a class="docs-heading-anchor" href="#Plot-objects">Plot objects</a><a id="Plot-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-objects" title="Permalink"></a></h3><p>If your data processing functions return <code>Plots</code> or <code>Makie</code> objects, that is supported out of the box. If you use some other package, or maybe want to save some other objects instead of or additionally to the plots, you have to define your own methods for two functions like following (see also package extension files in the <code>GivEmXL</code>&#39;s folder <code>ext/</code> as an example):</p><pre><code class="nohighlight hljs">import GivEmXL: isplot, save_plot
using Foo # you favorite plotting package

isplot(::Foo.foo_plot) = true
save_plot(pl::::Foo.foo_plot, fl) = Foo.saveplot(pl, fl)</code></pre><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>All three processing steps:</p><pre><code class="nohighlight hljs">function my_preproc(args...; kwargs...) 
    # do the job
return

function my_proc_subset(args...; kwargs...) 
    # do the job
return

function my_postproc(args...; kwargs...) 
    # do the job

complete_interact(pp0, pps, (my_preproc, my_proc_subset, my_postproc); getexel=true, getdata=(; dialogtype = :none))</code></pre><p>One processing step:</p><pre><code class="nohighlight hljs">function my_proc_everything(args...; kwargs...) 
    # do the job
return

complete_interact(pp0, pps, (my_proc_everything, nothing, nothing); getexel=true, getdata=(; dialogtype = :none))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../api_user-interaction/">API user interaction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 16 September 2024 19:58">Monday 16 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
